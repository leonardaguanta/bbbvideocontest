function itsg_ajaxupload_restore_input(t){var e=t.prev(),a=t.siblings(".progress"),_=t.siblings(".results"),s=t.siblings(".itsg_single_ajax_cancel"),i=t.siblings(".itsg_single_ajax_remove");t.show(),e.val(""),a.remove(),_.remove(),s.remove(),i.remove(),t.focus()}function itsg_ajaxupload_maybe_restore_buttons(){window.itsg_gf_ajaxupload_uploading||(jQuery(".gform_next_button").attr("value",window.itsg_gf_ajaxupload_next_value),jQuery(".gform_previous_button").attr("value",window.itsg_gf_ajaxupload_previous_value),jQuery('.gform_button[type="submit"]').attr("value",window.itsg_gf_ajaxupload_submit_value),jQuery("a.gform_save_link:not(.top_button)").text(window.itsg_gf_ajaxupload_save_value))}function itsg_ajaxupload_remove_upload(t,e){var a=itsg_gf_ajaxupload_js_settings.ajax_url,_=itsg_gf_ajaxupload_js_settings.allowdelete,s=itsg_gf_ajaxupload_js_settings.form_id,i=itsg_gf_ajaxupload_js_settings.entry_user_id;if(""!=t&&"null"!=t&&void 0!=t&&"1"==_){var r=decodeURIComponent(t.split("/").pop()),o={action:"itsg_ajaxupload_delete_file",file_name:r,form_id:s,entry_user_id:i};jQuery.ajax({url:a,type:"POST",data:o})}itsg_ajaxupload_restore_input(e)}function itsg_gf_ajaxupload_display_upload(t){var e=itsg_gf_ajaxupload_js_settings.thumbnail_enable,a=(parseInt(itsg_gf_ajaxupload_js_settings.thumbnail_width),itsg_gf_ajaxupload_js_settings.text_file),_=itsg_gf_ajaxupload_js_settings.text_new_window,s=itsg_gf_ajaxupload_js_settings.text_remove,i=(t.prev(),t.prev().val()),r=decodeURIComponent(i.split("/").pop()),o=i,l=r.substr(r.lastIndexOf(".")+1).toLowerCase();if(""!=i&&"null"!=i&&void 0!=i){t.after(jQuery("<div/>",{"class":"results"}).append(jQuery("<div/>",{"class":"results-bar results-bar-success"})));var n=t.next(".results"),u=t.next(".results").children().first(),g=jQuery.now();if(jQuery("<input/>",{"class":"button itsg_single_ajax_button itsg_single_ajax_remove",type:"button",value:s,"aria-describedby":"remove_"+g}).append(jQuery("<span/>",{id:"remove_"+g,"class":"sr-only",text:s+" "+a+" "+r})).insertAfter(t.next(".results")).click(function(){itsg_ajaxupload_remove_upload(i,t),jQuery(this).remove()}),t.hide(),n.show(),"1"==e&&"jpg"==l||"png"==l||"gif"==l||"jpeg"==l){var d=i.split("/").pop(),p=i.replace(d,"thumbnail/"+d);u.append(jQuery("<a/>",{href:o,target:"_blank","class":"thumbnail-link",title:_}).append(jQuery("<img/>",{src:p,"class":"thumbnail",onerror:"if (this.src != '"+o+"') this.src = '"+o+"';",alt:r,title:r}))),t.parent("td.gfield_list_cell").css("width","200px"),n.addClass("done-thumbnail")}else{if(r.length>60)var r=r.substring(0,60);u.append(jQuery("<a/>",{href:o,target:"_blank",alt:r,title:_,text:r})),n.addClass("done")}u.find("a").focus()}}function itsg_gf_ajaxupload_init(){var t=itsg_gf_ajaxupload_js_settings.ajax_url,e=parseInt(itsg_gf_ajaxupload_js_settings.file_size_kb),a=itsg_gf_ajaxupload_js_settings.file_types,_=itsg_gf_ajaxupload_js_settings.text_not_accepted_file_type,s=itsg_gf_ajaxupload_js_settings.text_file_size_too_big,i=itsg_gf_ajaxupload_js_settings.text_uploading,r=itsg_gf_ajaxupload_js_settings.text_error_title,o=itsg_gf_ajaxupload_js_settings.displayscripterrors,l=itsg_gf_ajaxupload_js_settings.text_complete,n=itsg_gf_ajaxupload_js_settings.text_cancel,u=(itsg_gf_ajaxupload_js_settings.text_remove,itsg_gf_ajaxupload_js_settings.thumbnail_enable,parseInt(itsg_gf_ajaxupload_js_settings.file_chunk_size)),g=itsg_gf_ajaxupload_js_settings.form_id,d=itsg_gf_ajaxupload_js_settings.user_id,p=itsg_gf_ajaxupload_js_settings.entry_user_id,j=itsg_gf_ajaxupload_js_settings.text_error_0,f=itsg_gf_ajaxupload_js_settings.text_error_404,x=itsg_gf_ajaxupload_js_settings.text_error_500,c=itsg_gf_ajaxupload_js_settings.text_error_parse,v=itsg_gf_ajaxupload_js_settings.text_error_timeout,m=itsg_gf_ajaxupload_js_settings.text_error_uncaught,y=itsg_gf_ajaxupload_js_settings.text_file,b=t,Q=0;jQuery("input.itsg_ajax_upload_browse").fileupload({maxChunkSize:u,url:b,dataType:"json",progressInterval:"500",add:function(t,r){var o=jQuery(this),l=r.originalFiles[0].name;jQuery(document).on("click",".delete_list_item",function(){var t=jQuery(this).parents("tr.gfield_list_group, tr.gfield_list_row_even, tr.gfield_list_row_odd");itsg_gf_ajaxupload_remove_list_item(t)});var u=[],g=new RegExp("(.|/)("+a+")$","i");if(g.test(l)||u.push(_),r.originalFiles[0].size>e&&(console.log(r.originalFiles[0].size),console.log(r.originalFiles[0].size.length),u.push(s)),u.length>0)alert(u.join("\n"));else{jQuery.blueimp.fileupload.prototype.options.add.call(this,t,r),r.submit(),o.hide();var d=jQuery.now();jQuery("<input/>",{"class":"button itsg_single_ajax_button itsg_single_ajax_cancel",type:"button",value:n,"aria-describedby":"cancel_"+d}).append(jQuery("<span/>",{id:"cancel_"+d,"class":"sr-only",text:n+" "+i+" "+y+" "+l})).insertAfter(o).click(function(){r.abort(),jQuery(this).remove(),itsg_ajaxupload_maybe_restore_buttons()}),o.after(jQuery("<div/>",{"class":"progress uploading"}).append(jQuery("<div/>",{"class":"progress-bar progress-bar-striped active",role:"progressbar","aria-valuemin":"0","aria-valuemax":"100"}).append(jQuery("<span/>",{"class":"sr-only"}))))}},done:function(t,e){window.itsg_gf_ajaxupload_uploading=!1;var a=jQuery(this);jQuery.each(e.result.files,function(t,e){return e.error?(alert(e.error),void itsg_ajaxupload_restore_input(a)):(a.prev().val(e.url),a.next().remove(),itsg_gf_ajaxupload_display_upload(a),void a.parent().find(".itsg_single_ajax_cancel").remove())}),itsg_ajaxupload_maybe_restore_buttons()},error:function(t,e,a){window.itsg_gf_ajaxupload_uploading=!1,"[object HTMLInputElement]"!=a&&"[object HTMLImageElement]"!=a&&"[object Object]"!=a&&"abort"!=a&&(0===t.status?error_message=j:404==t.status?error_message=f:500==t.status?error_message=x:"parsererror"===e?error_message=c:"timeout"===e?error_message=v:error_message=m+t.responseText,"1"==o?alert(r+"\n\n"+a+"\n\n"+error_message):alert(r),console.log(r+" "+a+" "+error_message))},progress:function(t,e){window.itsg_gf_ajaxupload_uploading=!0,jQuery('.gform_next_button, .gform_previous_button, .gform_button[type="submit"]').attr("value",i),jQuery("a.gform_save_link:not(.top_button)").text(i);var a=parseInt(e.loaded/e.total*100,10);jQuery(this).next().children().first().attr("aria-valuenow",a),jQuery(this).next().children().first().css("width",a+"%"),jQuery(this).next().children().first().attr("aria-valuetext",a+"% "+l),jQuery(this).next().find("span.sr-only").text(a+"% "+l),"100"==a&&jQuery(this).next().addClass("100"),Q+=1},fail:function(t,e){var a=jQuery(this);itsg_ajaxupload_restore_input(a)}}).on({fileuploadsubmit:function(t,e){e.formData={action:"itsg_ajaxupload_upload_file",field_id:jQuery(this).prev().attr("name").split("_").pop().trim().replace("[]",""),user_id:d,form_id:g,entry_user_id:p}}})}function maybePreventDefault(t){window.itsg_gf_ajaxupload_uploading&&(jQuery(".gform_ajax_spinner").hide(),t.preventDefault())}function itsg_gf_ajaxupload_disable_drop_function(){jQuery(".gform_body").bind("drop dragover",function(t){return!1})}function itsg_gf_ajaxupload_add_list_item(t){jQuery(t).find("input.itsg_ajax_upload_browse").each(function(){var t=jQuery(this);t.unbind().fileupload(),t.fileupload("destroy"),itsg_ajaxupload_restore_input(t)}),itsg_gf_ajaxupload_init()}function itsg_gf_ajaxupload_remove_list_item(t){jQuery(t).find("input.itsg_ajax_upload_browse").each(function(){var t=jQuery(this),e=jQuery(this).prev().val();itsg_ajaxupload_remove_upload(e,t)})}window.onerror=function(t,e,a){var _=itsg_gf_ajaxupload_js_settings.text_error,s=itsg_gf_ajaxupload_js_settings.text_line_number,i=itsg_gf_ajaxupload_js_settings.displayscripterrors;return console.log(_+":  "+t+" URL: "+e+" "+s+": "+a),"1"==i&&alert(_+": \n"+t+"\nURL: "+e+"\n"+s+": "+a),!0},"1"==itsg_gf_ajaxupload_js_settings.is_entry_detail?jQuery(document).ready(function(t){itsg_gf_ajaxupload_init(),itsg_gf_ajaxupload_disable_drop_function(),jQuery("input.itsg_ajax_upload_browse").each(function(){var t=jQuery(this);itsg_gf_ajaxupload_display_upload(t)}),jQuery(".gfield_list").on("click",".add_list_item",function(){var t=jQuery(this).parents("tr.gfield_list_group, tr.gfield_list_row_even, tr.gfield_list_row_odd").next("tr.gfield_list_group, tr.gfield_list_row_even, tr.gfield_list_row_odd");itsg_gf_ajaxupload_add_list_item(t)})}):jQuery(document).bind("gform_post_render",function(t){itsg_gf_ajaxupload_init(),itsg_gf_ajaxupload_disable_drop_function(),jQuery("input.itsg_ajax_upload_browse").each(function(){var t=jQuery(this);itsg_gf_ajaxupload_display_upload(t)}),jQuery(".gfield_list").on("click",".add_list_item",function(){var t=jQuery(this).parents("tr.gfield_list_group, tr.gfield_list_row_even, tr.gfield_list_row_odd").next("tr.gfield_list_group, tr.gfield_list_row_even, tr.gfield_list_row_odd");itsg_gf_ajaxupload_add_list_item(t)}),jQuery(" form").bind("submit",maybePreventDefault),window.itsg_gf_ajaxupload_next_value=jQuery(".gform_next_button").first().attr("value"),window.itsg_gf_ajaxupload_previous_value=jQuery(".gform_previous_button").first().attr("value"),window.itsg_gf_ajaxupload_submit_value=jQuery('.gform_button[type="submit"]').first().attr("value"),window.itsg_gf_ajaxupload_save_value=jQuery("a.gform_save_link:not(.top_button)").first().text()});